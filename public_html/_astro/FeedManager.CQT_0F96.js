import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.DiEladB3.js";import{c as v}from"./createLucideIcon.rW8VcTAn.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],A=v("ellipsis",B);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],D=v("globe",U);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],L=v("image",R);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M18 13a6 6 0 0 1-6 5 6 6 0 0 1-6-5h12Z",key:"b2q4dd"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],q=v("laugh",F);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],J=v("message-circle",T);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Q=v("send",H);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],M=v("thumbs-up",Z);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],$=v("trash-2",G);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],K=v("users",X);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Y=v("video",W);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],E=v("x",V);function ee({onClick:t,userName:m}){const[d,l]=a.useState({name:m,profile_photo:""});return a.useEffect(()=>{const n=()=>{const i=JSON.parse(localStorage.getItem("user_session")||"{}");i.name&&l({name:i.name,profile_photo:i.profile_photo||""})};return n(),window.addEventListener("user_session_updated",n),()=>window.removeEventListener("user_session_updated",n)},[]),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-5 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 flex-shrink-0 flex items-center justify-center text-white font-bold overflow-hidden border",children:d.profile_photo?e.jsx("img",{src:d.profile_photo,className:"w-full h-full object-cover"}):e.jsx("span",{children:d.name[0]})}),e.jsxs("button",{onClick:t,className:"flex-1 bg-gray-100 hover:bg-gray-200 rounded-full px-4 py-2.5 text-left text-gray-500 text-[15px] transition-colors",children:["¿Qué estás pensando, ",d.name,"?"]})]}),e.jsxs("div",{className:"flex gap-1 border-t pt-2",children:[e.jsxs("button",{onClick:t,className:"flex-1 flex items-center justify-center gap-2 py-2 hover:bg-gray-50 rounded-lg text-red-500 font-semibold text-sm transition-colors",children:[e.jsx(Y,{size:20})," Video en vivo"]}),e.jsxs("button",{onClick:t,className:"flex-1 flex items-center justify-center gap-2 py-2 hover:bg-gray-50 rounded-lg text-green-500 font-semibold text-sm transition-colors",children:[e.jsx(L,{size:20})," Foto/video"]}),e.jsxs("button",{onClick:t,className:"flex-1 flex items-center justify-center gap-2 py-2 hover:bg-gray-50 rounded-lg text-yellow-500 font-semibold text-sm transition-colors",children:[e.jsx(q,{size:20})," Sentimiento/actividad"]})]})]})}function te({postId:t}){const[m,d]=a.useState([]),[l,n]=a.useState(""),[i,p]=a.useState(!1),[x,g]=a.useState({show:!1,id:null}),[w,h]=a.useState(null),y=JSON.parse(localStorage.getItem("user_session")||"{}"),r=a.useRef(null),u=async()=>{try{const j=await(await fetch(`/api/comments/get.php?post_id=${t}`)).json();Array.isArray(j)&&d(j)}catch(s){console.error("Error al cargar comentarios:",s)}};a.useEffect(()=>{u();const s=j=>{r.current&&!r.current.contains(j.target)&&h(null)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[t]);const o=async s=>{if(s.preventDefault(),!(!l.trim()||i||!y.id)){p(!0);try{const _=await(await fetch("/api/comments/save.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:t,user_id:y.id,content:l.trim()})})).json();_.success?(n(""),await u(),window.dispatchEvent(new Event("user_session_updated"))):console.error("Error del servidor:",_.message)}catch(j){console.error("Error de red:",j)}finally{p(!1)}}},f=async()=>{if(x.id){try{(await(await fetch("/api/comments/delete.php",{method:"POST",body:new URLSearchParams({comment_id:x.id.toString(),user_id:y.id})})).json()).success&&(d(_=>_.filter(S=>S.id!==x.id)),window.dispatchEvent(new Event("user_session_updated")))}catch(s){console.error(s)}g({show:!1,id:null})}};return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-[#242526]",children:[e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:m.map(s=>e.jsxs("div",{id:`comment-${s.id}`,className:"flex gap-2 group items-start",children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden flex-shrink-0 mt-1 border dark:border-[#3E4042]",children:e.jsx("img",{src:s.profile_photo||"/default-avatar.jpg",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col max-w-[85%] relative",children:[e.jsxs("div",{className:"bg-gray-100 dark:bg-[#3A3B3C] px-3 py-2 rounded-2xl",children:[e.jsx("p",{className:"text-[13px] font-bold dark:text-white leading-tight mb-0.5",children:s.full_name}),e.jsx("p",{className:"text-[14px] dark:text-gray-200 leading-snug",children:s.content})]}),e.jsxs("div",{className:"flex gap-3 px-2 mt-1 text-[12px] font-bold text-gray-500 dark:text-gray-400",children:[e.jsx("button",{className:"hover:underline",children:"Me gusta"}),e.jsx("span",{children:"Hace un momento"})]})]}),y.id===s.user_id&&e.jsxs("div",{className:"relative self-center",ref:w===s.id?r:null,children:[e.jsx("button",{onClick:()=>h(w===s.id?null:s.id),className:"p-1.5 opacity-0 group-hover:opacity-100 hover:bg-gray-100 dark:hover:bg-[#3A3B3C] rounded-full text-gray-500 transition-all",children:e.jsx(A,{size:16})}),w===s.id&&e.jsx("div",{className:"absolute left-0 mt-1 w-40 bg-white dark:bg-[#242526] shadow-xl rounded-lg border dark:border-[#3E4042] py-1 z-50 animate-in zoom-in-95",children:e.jsxs("button",{onClick:()=>{g({show:!0,id:s.id}),h(null)},className:"w-full flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-[#3A3B3C] font-semibold text-xs transition-colors",children:[e.jsx($,{size:14})," Eliminar"]})})]})]},s.id))}),e.jsx("div",{className:"p-4 border-t dark:border-[#3E4042] bg-white dark:bg-[#242526]",children:e.jsxs("form",{onSubmit:o,className:"flex gap-2 items-center bg-gray-100 dark:bg-[#3A3B3C] rounded-full px-4 py-2",children:[e.jsx("input",{type:"text",placeholder:"Escribe un comentario...",className:"flex-1 bg-transparent outline-none text-[15px] dark:text-white",value:l,onChange:s=>n(s.target.value)}),e.jsx("button",{type:"submit",disabled:!l.trim()||i,className:"text-blue-600 disabled:opacity-30",children:e.jsx(Q,{size:18})})]})}),x.show&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[4000] flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-[#242526] w-full max-w-[500px] rounded-xl shadow-2xl overflow-hidden animate-in zoom-in-95 duration-200 border dark:border-[#3E4042]",children:[e.jsxs("div",{className:"p-4 border-b dark:border-[#3E4042] flex justify-between items-center relative",children:[e.jsx("h3",{className:"text-xl font-bold dark:text-white w-full text-center",children:"¿Eliminar comentario?"}),e.jsx("button",{onClick:()=>g({show:!1,id:null}),className:"absolute right-4 p-1.5 bg-gray-100 dark:bg-[#3A3B3C] hover:bg-gray-200 dark:hover:bg-[#4E4F50] rounded-full text-gray-600 dark:text-gray-300 transition-colors",children:e.jsx(E,{size:20})})]}),e.jsx("div",{className:"p-6 text-[15px] text-gray-600 dark:text-gray-300",children:"¿Confirmas que quieres eliminar este comentario?"}),e.jsxs("div",{className:"p-4 flex justify-end items-center gap-4",children:[e.jsx("button",{onClick:()=>g({show:!1,id:null}),className:"text-blue-600 font-bold hover:underline px-2",children:"No"}),e.jsx("button",{onClick:f,className:"bg-[#1877f2] hover:bg-[#166fe5] text-white px-8 py-2 rounded-lg font-bold shadow-md transition-all active:scale-95",children:"Eliminar"})]})]})})]})}function se({isOpen:t,onClose:m,onPostSuccess:d,user:l,postToView:n}){const[i,p]=a.useState(""),[x,g]=a.useState(null),[w,h]=a.useState(null),[y,r]=a.useState(!1),[u,o]=a.useState([]),[f,s]=a.useState(!1),j=a.useRef(null);a.useEffect(()=>{n||(p(""),g(null),h(null),s(!1))},[t,n]);const _=async c=>{const b=c.target.value;p(b);const N=b.lastIndexOf("@");if(N!==-1&&(N===0||b[N-1]===" ")){const C=b.substring(N+1).split(/\s/)[0];if(C.length>=2)try{const O=await(await fetch(`/api/users/search.php?q=${C}`)).json();o(O),s(!0)}catch(z){console.error(z)}else s(!1)}else s(!1)},S=c=>{const b=i.lastIndexOf("@"),N=i.substring(0,b);p(N+"@"+c+" "),s(!1)};if(!t)return null;const k=!!n,I=async()=>{if(!i.trim()&&!x)return;if(!l.id||l.id===0){alert("Sesión no válida");return}r(!0);const c=new FormData;c.append("content",i),c.append("user_id",l.id.toString()),x&&c.append("image",x);try{(await(await fetch("/api/posts/save.php",{method:"POST",body:c})).json()).success&&(await d(),m())}catch(b){console.error(b)}finally{r(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-white/90 dark:bg-[#1c1c1d]/90 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-[#242526] w-full max-w-[600px] rounded-2xl shadow-2xl border dark:border-[#3E4042] flex flex-col overflow-hidden max-h-[90vh] relative",children:[f&&u.length>0&&!k&&e.jsxs("div",{className:"absolute top-[180px] left-6 w-72 bg-white dark:bg-[#242526] shadow-2xl rounded-xl border dark:border-[#3E4042] py-2 z-[120] animate-in zoom-in-95",children:[e.jsx("p",{className:"px-4 py-1 text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Mencionar a:"}),u.map(c=>e.jsxs("button",{onClick:()=>S(c.full_name),className:"w-full flex items-center gap-3 px-4 py-2 hover:bg-blue-50 dark:hover:bg-[#3A3B3C] text-left transition-colors",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold overflow-hidden border",children:c.profile_photo?e.jsx("img",{src:c.profile_photo,className:"w-full h-full object-cover"}):c.full_name[0]}),e.jsx("span",{className:"text-sm font-bold dark:text-white",children:c.full_name})]},c.id))]}),e.jsxs("div",{className:"p-4 border-b dark:border-[#3E4042] flex justify-between items-center relative",children:[e.jsx("h2",{className:"text-xl font-bold w-full text-center dark:text-white",children:k?"Publicación":"Crear publicación"}),e.jsx("button",{onClick:m,className:"absolute right-4 top-3.5 p-1.5 bg-gray-100 dark:bg-[#3A3B3C] rounded-full dark:text-white transition-colors",children:e.jsx(E,{size:20})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold overflow-hidden border",children:(k?n.profile_photo:l.profile_photo)?e.jsx("img",{src:k?n.profile_photo:l.profile_photo,className:"w-full h-full object-cover"}):(k?n.full_name:l.name)?.[0]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold dark:text-white",children:k?n.full_name:l.name}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 dark:bg-[#3A3B3C] px-2 py-0.5 rounded text-[12px] font-bold dark:text-gray-300",children:[e.jsx(K,{size:12})," Amigos"]})]})]}),k?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-800 dark:text-gray-200 text-lg leading-normal",children:n.content}),n.image_url&&e.jsx("img",{src:n.image_url,className:"w-full rounded-xl border dark:border-[#3E4042]"}),e.jsx("div",{className:"mt-6 border-t dark:border-[#3E4042] pt-4",children:e.jsx(te,{postId:n.id,user:l})})]}):e.jsxs(e.Fragment,{children:[e.jsx("textarea",{autoFocus:!0,className:"w-full text-lg border-none focus:ring-0 min-h-[150px] resize-none dark:bg-transparent dark:text-white",placeholder:`¿Qué estás pensando, ${l.name}?`,value:i,onChange:_}),w&&e.jsxs("div",{className:"relative mb-4",children:[e.jsx("img",{src:w,className:"w-full h-48 object-cover rounded-xl border dark:border-[#3E4042]"}),e.jsx("button",{onClick:()=>{g(null),h(null)},className:"absolute top-2 right-2 p-1 bg-black/50 text-white rounded-full",children:e.jsx(E,{size:16})})]}),e.jsxs("div",{className:"border dark:border-[#3E4042] rounded-xl p-3 flex justify-between items-center mb-4",children:[e.jsx("span",{className:"font-bold dark:text-white",children:"Agregar a tu publicación"}),e.jsxs("button",{onClick:()=>j.current?.click(),className:"text-green-500 hover:bg-gray-100 dark:hover:bg-[#3A3B3C] p-2 rounded-full",children:[e.jsx(L,{size:24}),e.jsx("input",{type:"file",hidden:!0,ref:j,onChange:c=>{const b=c.target.files?.[0];b&&(g(b),h(URL.createObjectURL(b)))}})]})]}),e.jsx("button",{onClick:I,disabled:y||!i.trim()&&!x,className:"w-full py-2.5 bg-[#1877F2] text-white font-bold rounded-lg disabled:bg-gray-200",children:y?"Publicando...":"Publicar"})]})]})]})})}function ae({post:t,onOpenComments:m}){const[d,l]=a.useState(!1),[n,i]=a.useState(!1),p=a.useRef(null),x=JSON.parse(localStorage.getItem("user_session")||"{}"),g=x.id===t.user_id;a.useEffect(()=>{const r=u=>{p.current&&!p.current.contains(u.target)&&l(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const w=r=>{const u=new Date,o=new Date(r),f=Math.floor((u.getTime()-o.getTime())/1e3);return f<60?"Hace un momento":f<3600?`${Math.floor(f/60)} min`:f<86400?`${Math.floor(f/3600)} h`:f<604800?`${Math.floor(f/86400)} d`:o.toLocaleDateString()},h=async()=>{try{if((await(await fetch("/api/posts/delete.php",{method:"POST",body:new URLSearchParams({post_id:t.id,user_id:x.id})})).json()).success){const o=document.getElementById(`post-${t.id}`);o&&(o.style.opacity="0",o.style.transform="scale(0.95)",setTimeout(()=>o.remove(),300))}}catch(r){console.error("Error al borrar:",r)}i(!1)},y=t.content.includes("actualizó su foto")||t.content.includes("ha actualizado su foto");return e.jsxs("div",{id:`post-${t.id}`,className:"bg-white dark:bg-[#242526] rounded-xl shadow-sm border border-gray-200 dark:border-[#3E4042] overflow-hidden mb-4 font-sans transition-all duration-300",children:[e.jsxs("div",{className:"flex items-start justify-between p-4 pb-2",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden flex-shrink-0 border dark:border-[#4E4F50]",children:t.profile_photo?e.jsx("img",{src:t.profile_photo,className:"w-full h-full object-cover"}):t.full_name?.[0]||"U"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-x-1.5 leading-tight",children:[e.jsx("span",{className:"font-bold dark:text-white text-[15px] hover:underline cursor-pointer",children:t.full_name||"Usuario"}),y&&e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-[15px] font-normal",children:t.content})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[12px] text-gray-500 dark:text-gray-400 font-medium mt-0.5",children:[e.jsx("span",{children:w(t.created_at)}),e.jsx("span",{children:"·"}),e.jsx(D,{size:12})]})]})]}),e.jsxs("div",{className:"relative",ref:p,children:[e.jsx("button",{onClick:()=>l(!d),className:"p-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-full text-gray-500 transition-colors",children:e.jsx(A,{size:20})}),d&&g&&e.jsx("div",{className:"absolute right-0 mt-2 w-52 bg-white dark:bg-[#242526] shadow-xl rounded-lg border dark:border-[#3E4042] py-2 z-50 animate-in zoom-in-95 duration-100",children:e.jsxs("button",{onClick:()=>{i(!0),l(!1)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-red-600 hover:bg-gray-100 dark:hover:bg-[#3A3B3C] font-semibold text-sm transition-colors",children:[e.jsx($,{size:18})," Eliminar publicación"]})})]})]}),!y&&e.jsx("div",{className:"px-4 pb-3 text-[15px] dark:text-gray-200 leading-normal",children:t.content}),t.image_url&&e.jsx("div",{className:"bg-gray-100 dark:bg-black/10 border-t dark:border-[#3E4042]",children:e.jsx("img",{src:t.image_url,className:"w-full h-auto max-h-[600px] object-contain cursor-pointer",onClick:m})}),e.jsxs("div",{className:"px-4 py-2 flex justify-between text-[13px] text-gray-500 border-b dark:border-[#3E4042]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"bg-blue-500 p-1 rounded-full text-white",children:e.jsx(M,{size:10,fill:"white"})}),e.jsx("span",{children:t.likes_total||0})]}),e.jsxs("div",{className:"hover:underline cursor-pointer",onClick:m,children:[t.comments_total||0," comentarios"]})]}),e.jsxs("div",{className:"flex p-1",children:[e.jsxs("button",{className:"flex-1 py-2 rounded-md hover:bg-black/5 dark:hover:bg-white/5 flex items-center justify-center gap-2 font-bold text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(M,{size:18})," Me gusta"]}),e.jsxs("button",{onClick:m,className:"flex-1 py-2 rounded-md hover:bg-black/5 dark:hover:bg-white/5 flex items-center justify-center gap-2 text-gray-600 dark:text-gray-400 font-bold text-sm",children:[e.jsx(J,{size:18})," Comentar"]})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[2000] flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-[#242526] w-full max-w-[500px] rounded-xl shadow-2xl overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-4 border-b dark:border-[#3E4042] flex justify-between items-center relative",children:[e.jsx("h3",{className:"text-xl font-bold dark:text-white w-full text-center",children:"¿Eliminar Publicación?"}),e.jsx("button",{onClick:()=>i(!1),className:"absolute right-4 p-1.5 bg-gray-100 dark:bg-[#3A3B3C] hover:bg-gray-200 dark:hover:bg-[#4E4F50] rounded-full text-gray-600 dark:text-gray-300",children:e.jsx(E,{size:20})})]}),e.jsx("div",{className:"p-6 text-[15px] text-gray-600 dark:text-gray-300",children:"¿Confirmas que quieres eliminar esta publicación?"}),e.jsxs("div",{className:"p-4 flex justify-end items-center gap-4",children:[e.jsx("button",{onClick:()=>i(!1),className:"text-blue-600 font-bold hover:underline px-2",children:"No"}),e.jsx("button",{onClick:h,className:"bg-[#1877f2] hover:bg-[#166fe5] text-white px-8 py-2 rounded-lg font-bold shadow-md transition-all active:scale-95",children:"Eliminar"})]})]})})]})}function P(){return e.jsxs("div",{className:"bg-white dark:bg-[#242526] rounded-xl shadow-sm border border-gray-200 dark:border-[#3E4042] p-4 mb-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-[#3A3B3C]"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-[#3A3B3C] rounded w-1/3"}),e.jsx("div",{className:"h-2 bg-gray-100 dark:bg-[#3E4042] rounded w-1/4"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-[#3A3B3C] rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-[#3A3B3C] rounded w-5/6"}),e.jsx("div",{className:"h-[300px] bg-gray-100 dark:bg-[#3A3B3C] rounded-xl mt-4"})]})]})}function ie(){const[t,m]=a.useState(!1),[d,l]=a.useState([]),[n,i]=a.useState(!0),[p,x]=a.useState(null),[g,w]=a.useState({id:0,name:"Usuario"}),h=async()=>{const u=JSON.parse(localStorage.getItem("user_session")||"{}").id||0;i(!0);try{const f=await(await fetch(`/api/posts/get_all.php?user_id=${u}&t=${Date.now()}`)).json();l(Array.isArray(f)?f:[])}catch(o){console.error("Error al cargar posts:",o)}finally{i(!1)}};a.useEffect(()=>{const r=JSON.parse(localStorage.getItem("user_session")||"{}");return r.id&&w(r),h(),window.addEventListener("user_session_updated",h),()=>window.removeEventListener("user_session_updated",h)},[]),a.useEffect(()=>{if(!n&&d.length>0){const u=new URLSearchParams(window.location.search).get("post_id");u&&setTimeout(()=>{const o=document.getElementById(`post-${u}`);o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),o.classList.add("ring-4","ring-blue-500/50"),setTimeout(()=>o.classList.remove("ring-4","ring-blue-500/50"),3e3))},600)}},[n,d]);const y=r=>{x(r),m(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{onClick:()=>{x(null),m(!0)},userName:g.name}),e.jsx(se,{isOpen:t,onClose:()=>{m(!1),x(null)},onPostSuccess:h,user:g,postToView:p}),e.jsx("div",{className:"space-y-4 mt-4 pb-12",children:n?e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsx(P,{})]}):d.length>0?d.map(r=>e.jsx(ae,{post:r,onOpenComments:()=>y(r)},r.id)):e.jsx("div",{className:"bg-white p-12 rounded-xl text-center text-gray-400 border shadow-sm",children:"No hay publicaciones en la villa."})})]})}export{ie as default};
