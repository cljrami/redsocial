import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.DYrVU9rO.js";import{c as k}from"./createLucideIcon.DCJxLUv2.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],N=k("camera",C);function z(){const[r,_]=o.useState({id:null,name:"Usuario",profile_photo:"",cover_photo:""}),[i,m]=o.useState(null),[n,u]=o.useState(null),[h,f]=o.useState(""),[x,g]=o.useState(""),[b,v]=o.useState(!1),c=()=>{const s=JSON.parse(localStorage.getItem("user_session")||"{}");_({id:s.id||null,name:s.name||s.full_name||"Usuario",profile_photo:s.profile_photo||"",cover_photo:s.cover_photo||""})};o.useEffect(()=>(c(),window.addEventListener("user_session_updated",c),()=>window.removeEventListener("user_session_updated",c)),[]);const w=(s,d)=>{const a=s.target.files?.[0];if(!a)return;const t=new FileReader;t.onloadend=()=>{d==="profile"?(m(a),f(t.result)):(u(a),g(t.result))},t.readAsDataURL(a)},j=()=>{m(null),u(null),f(""),g("")},y=async()=>{if(!r.id)return;v(!0);const s=new FormData;s.append("user_id",r.id);const d=i?"profile":"cover";i?s.append("photo",i):n&&s.append("photo",n),s.append("type",d);try{const t=await(await fetch("/api/user/update_photos.php",{method:"POST",body:s})).json();if(t.success){const p=JSON.parse(localStorage.getItem("user_session")||"{}");i&&(p.profile_photo=t.url),n&&(p.cover_photo=t.url),localStorage.setItem("user_session",JSON.stringify(p));const S=d==="profile"?"actualizó su foto de perfil.":"actualizó su foto de portada.",l=new FormData;l.append("user_id",r.id),l.append("content",S),l.append("image_url",t.url),await fetch("/api/posts/save.php",{method:"POST",body:l}),window.dispatchEvent(new Event("user_session_updated")),j()}}catch(a){console.error("Error al guardar:",a)}v(!1)};return e.jsxs("div",{className:"bg-white dark:bg-[#242526] shadow-sm border-b dark:border-[#3E4042] relative",children:[(h||x)&&e.jsx("div",{className:"fixed top-14 inset-x-0 z-[100] bg-blue-600 text-white py-3 px-4 shadow-lg animate-in slide-in-from-top duration-300",children:e.jsxs("div",{className:"max-w-[940px] mx-auto flex justify-between items-center",children:[e.jsx("p",{className:"font-medium",children:"¿Deseas guardar los cambios en tus fotos?"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:j,className:"px-4 py-1.5 rounded-md hover:bg-white/10 font-bold",children:"Cancelar"}),e.jsx("button",{onClick:y,disabled:b,className:"bg-white text-blue-600 px-4 py-1.5 rounded-md font-bold shadow-sm",children:b?"Guardando...":"Guardar cambios"})]})]})}),e.jsxs("div",{className:"max-w-[940px] mx-auto",children:[e.jsxs("div",{className:"h-[200px] md:h-[350px] bg-gray-200 dark:bg-[#3A3B3C] relative overflow-hidden md:rounded-b-xl group",children:[e.jsx("img",{src:x||r.cover_photo,className:"w-full h-full object-cover"}),e.jsxs("label",{className:"absolute bottom-4 right-4 bg-white dark:bg-[#4E4F50] px-4 py-2 rounded-lg shadow-md cursor-pointer flex items-center gap-2 font-bold dark:text-white z-20 hover:bg-gray-100 transition-colors",children:[e.jsx(N,{size:20})," ",e.jsx("span",{className:"hidden md:inline text-sm",children:"Editar foto de portada"}),e.jsx("input",{type:"file",className:"hidden",onChange:s=>w(s,"cover")})]})]}),e.jsxs("div",{className:"px-4 pb-6 flex flex-col items-center md:items-end md:flex-row -mt-12 md:-mt-16 relative z-10 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 md:w-40 md:h-40 rounded-full border-4 border-white dark:border-[#242526] bg-gray-800 overflow-hidden shadow-xl",children:e.jsx("img",{src:h||r.profile_photo,className:"w-full h-full object-cover"})}),e.jsxs("label",{className:"absolute bottom-2 right-2 bg-gray-200 dark:bg-[#3A3B3C] p-2 rounded-full border-4 border-white dark:border-[#242526] cursor-pointer shadow-md hover:bg-gray-300 transition-colors",children:[e.jsx(N,{size:20,className:"dark:text-white"}),e.jsx("input",{type:"file",className:"hidden",onChange:s=>w(s,"profile")})]})]}),e.jsxs("div",{className:"text-center md:text-left flex-1 pb-2",children:[e.jsx("h1",{className:"text-3xl font-extrabold dark:text-white",children:r.name}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-bold",children:"Residente Verificado"})]})]})]})]})}export{z as default};
