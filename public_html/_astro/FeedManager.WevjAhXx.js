import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.DiEladB3.js";import{c}from"./createLucideIcon.rW8VcTAn.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],C=c("ellipsis",_);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],A=c("globe",S);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],k=c("image",E);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M18 13a6 6 0 0 1-6 5 6 6 0 0 1-6-5h12Z",key:"b2q4dd"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],M=c("laugh",z);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],$=c("message-circle",P);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],B=c("share-2",L);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],j=c("thumbs-up",F);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],D=c("users",O);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],U=c("video",I);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],v=c("x",q);function R({onClick:s,userName:a}){return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 flex-shrink-0 flex items-center justify-center text-white font-bold",children:a[0]}),e.jsxs("button",{onClick:s,className:"flex-1 bg-gray-100 hover:bg-gray-200 rounded-full px-4 py-2.5 text-left text-gray-500 text-[15px]",children:["¿Qué estás pensando, ",a,"?"]})]}),e.jsxs("div",{className:"flex gap-1 border-t pt-2",children:[e.jsxs("button",{onClick:s,className:"flex-1 flex items-center justify-center gap-2 py-2 hover:bg-gray-50 rounded-lg text-red-500 font-semibold text-sm transition-colors",children:[e.jsx(U,{size:20})," Video en vivo"]}),e.jsxs("button",{onClick:s,className:"flex-1 flex items-center justify-center gap-2 py-2 hover:bg-gray-50 rounded-lg text-green-500 font-semibold text-sm transition-colors",children:[e.jsx(k,{size:20})," Foto/video"]}),e.jsxs("button",{onClick:s,className:"flex-1 flex items-center justify-center gap-2 py-2 hover:bg-gray-50 rounded-lg text-yellow-500 font-semibold text-sm transition-colors",children:[e.jsx(M,{size:20})," Sentimiento/actividad"]})]})]})}function T({postId:s,user:a}){const[u,l]=n.useState([]),[r,i]=n.useState(""),x=async()=>{const g=await(await fetch(`/api/comments/get.php?post_id=${s}&user_id=${a.id}`)).json();l(g)};n.useEffect(()=>(x(),window.addEventListener("user_session_updated",x),()=>window.removeEventListener("user_session_updated",x)),[s]);const m=async()=>{if(!r.trim())return;const t={id:Date.now(),full_name:a.name||"Administrador",content:r,created_at:new Date().toISOString(),is_temp:!0};l(d=>[...d,t]);const g=r;i("");try{await fetch("/api/comments/save.php",{method:"POST",body:JSON.stringify({post_id:s,user_id:a.id,content:g}),headers:{"Content-Type":"application/json"}}),x()}catch{l(p=>p.filter(y=>y.id!==t.id))}};return e.jsxs("div",{className:"bg-white dark:bg-[#242526] p-4 border-t dark:border-[#3E4042]",children:[e.jsx("div",{className:"space-y-4 mb-4",children:u.map(t=>e.jsxs("div",{className:`flex gap-2 ${t.is_temp?"opacity-50":""}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex-shrink-0 flex items-center justify-center text-white text-[12px] font-bold overflow-hidden",children:a.profile_photo?e.jsx("img",{src:a.profile_photo,className:"w-full h-full object-cover"}):t.full_name[0]}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"bg-gray-100 dark:bg-[#3A3B3C] rounded-2xl px-3 py-2",children:[e.jsx("p",{className:"text-[13px] font-bold dark:text-white leading-tight",children:t.full_name}),e.jsx("p",{className:"text-[14px] dark:text-gray-200",children:t.content})]})})]},t.id))}),e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{type:"text",placeholder:"Escribe un comentario...",className:"flex-1 bg-gray-100 dark:bg-[#3A3B3C] dark:text-white rounded-full px-4 py-2 outline-none",value:r,onChange:t=>i(t.target.value),onKeyDown:t=>t.key==="Enter"&&m()})})]})}function H({isOpen:s,onClose:a,onPostSuccess:u,user:l,postToView:r}){const[i,x]=n.useState(""),[m,t]=n.useState(null),[g,d]=n.useState(null),[p,y]=n.useState(!1),o=n.useRef(null);if(!s)return null;const f=!!r,w=async()=>{if(!i.trim()&&!m)return;y(!0);const h=new FormData;h.append("content",i),h.append("user_id",l.id),m&&h.append("image",m);try{(await(await fetch("/api/posts/save.php",{method:"POST",body:h})).json()).success&&(x(""),t(null),d(null),await u(),a())}catch(b){console.error(b)}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-white/90 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-[600px] rounded-2xl shadow-2xl border border-gray-100 overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"relative p-4 border-b text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:f?"Publicación":"Crear publicación"}),e.jsx("button",{onClick:a,className:"absolute right-4 top-3.5 p-1.5 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-600 transition-colors",children:e.jsx(v,{size:20})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold",children:f?r.full_name[0]:l.name[0]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:f?r.full_name:l.name}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 px-2 py-0.5 rounded-md text-[12px] font-bold text-gray-600",children:[e.jsx(D,{size:12})," Amigos ",e.jsx(A,{size:10})]})]})]}),f?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-800 text-lg",children:r.content}),r.image_url&&e.jsx("img",{src:r.image_url,className:"w-full rounded-xl border"}),e.jsx("div",{className:"mt-6 border-t pt-4",children:e.jsx(T,{postId:r.id,user:l})})]}):e.jsxs(e.Fragment,{children:[e.jsx("textarea",{autoFocus:!0,className:"w-full text-xl placeholder-gray-400 border-none focus:ring-0 min-h-[120px] resize-none",placeholder:`¿Qué estás pensando, ${l.name}?`,value:i,onChange:h=>x(h.target.value)}),g&&e.jsxs("div",{className:"relative mb-4 rounded-xl overflow-hidden border",children:[e.jsx("img",{src:g,className:"w-full h-auto max-h-64 object-cover"}),e.jsx("button",{onClick:()=>{t(null),d(null)},className:"absolute top-2 right-2 p-1.5 bg-white rounded-full",children:e.jsx(v,{size:16})})]}),e.jsxs("div",{className:"border rounded-xl p-3 flex items-center justify-between mb-5",children:[e.jsx("span",{className:"font-bold text-[15px]",children:"Agregar a tu publicación"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"file",hidden:!0,ref:o,accept:"image/*",onChange:h=>{const b=h.target.files?.[0];b&&(t(b),d(URL.createObjectURL(b)))}}),e.jsx("button",{onClick:()=>o.current?.click(),className:"p-2 text-green-500 hover:bg-gray-100 rounded-full",children:e.jsx(k,{size:24})})]})]}),e.jsx("button",{onClick:w,disabled:p||!i.trim()&&!m,className:"w-full py-2.5 rounded-lg font-bold text-white bg-[#1877F2] hover:bg-[#166fe5] disabled:bg-gray-200",children:p?"Publicando...":"Publicar"})]})]})]})})}function J({post:s,onOpenComments:a}){const[u,l]=n.useState({id:1,name:"Administrador",profile_photo:""});return n.useEffect(()=>{const r=JSON.parse(localStorage.getItem("user_session")||"{}");l(i=>({...i,...r}))},[]),e.jsxs("div",{className:"bg-white dark:bg-[#242526] rounded-xl shadow-sm border border-gray-200 dark:border-[#3E4042] overflow-hidden mb-4 transition-colors font-sans",children:[e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center text-white font-bold overflow-hidden border dark:border-[#4E4F50]",children:u.profile_photo?e.jsx("img",{src:u.profile_photo,className:"w-full h-full object-cover"}):"A"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold dark:text-white text-[15px] leading-tight hover:underline cursor-pointer",children:s.full_name||"Administrador"}),e.jsx("p",{className:"text-[13px] text-gray-500 dark:text-gray-400",children:new Date(s.created_at).toLocaleString()})]})]}),e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-[#3A3B3C] rounded-full text-gray-600 dark:text-gray-400",children:e.jsx(C,{size:20})})]}),e.jsx("div",{className:"px-4 pb-3 text-[15px] text-gray-800 dark:text-gray-200 leading-normal",children:s.content}),s.image_url&&e.jsx("div",{className:"bg-gray-100 dark:bg-[#3A3B3C] border-y dark:border-[#3E4042] cursor-pointer",onClick:a,children:e.jsx("img",{src:s.image_url,className:"w-full max-h-[500px] object-contain mx-auto",alt:"Contenido"})}),e.jsxs("div",{className:"px-4 py-2 flex justify-between items-center border-b dark:border-[#3E4042] text-gray-500 dark:text-gray-400 text-[14px]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"bg-blue-500 p-1 rounded-full text-white flex items-center justify-center",children:e.jsx(j,{size:10,fill:"white"})}),e.jsx("span",{children:s.likes_total||0})]}),e.jsxs("div",{className:"hover:underline cursor-pointer",onClick:a,children:[s.comments_total||0," comentarios"]})]}),e.jsxs("div",{className:"flex px-1 py-1",children:[e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-[#3A3B3C] text-gray-600 dark:text-gray-300 font-bold text-sm transition-colors",children:[e.jsx(j,{size:20,className:s.user_has_liked?"text-blue-600 fill-current":""}),e.jsx("span",{children:"Me gusta"})]}),e.jsxs("button",{onClick:a,className:"flex-1 flex items-center justify-center gap-2 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-[#3A3B3C] text-gray-600 dark:text-gray-300 font-bold text-sm transition-colors",children:[e.jsx($,{size:20}),e.jsx("span",{children:"Comentar"})]}),e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-[#3A3B3C] text-gray-600 dark:text-gray-300 font-bold text-sm transition-colors",children:[e.jsx(B,{size:20}),e.jsx("span",{children:"Compartir"})]})]})]})}function N(){return e.jsxs("div",{className:"bg-white dark:bg-[#242526] rounded-xl shadow-sm border border-gray-200 dark:border-[#3E4042] p-4 mb-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-[#3A3B3C]"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-[#3A3B3C] rounded w-1/3"}),e.jsx("div",{className:"h-2 bg-gray-100 dark:bg-[#3E4042] rounded w-1/4"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-[#3A3B3C] rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-[#3A3B3C] rounded w-5/6"}),e.jsx("div",{className:"h-[300px] bg-gray-100 dark:bg-[#3A3B3C] rounded-xl mt-4"})]})]})}function X(){const[s,a]=n.useState(!1),[u,l]=n.useState([]),[r,i]=n.useState(!0),[x,m]=n.useState(null),[t,g]=n.useState({id:1,name:"Administrador"}),d=async()=>{i(!0);try{const f=await(await fetch(`/api/posts/get_all.php?user_id=${t.id}&t=${Date.now()}`)).json();l(Array.isArray(f)?f:[])}catch(o){console.error(o)}finally{setTimeout(()=>i(!1),600)}},p=o=>{m(o),a(!0)},y=()=>{a(!1),m(null)};return n.useEffect(()=>(d(),window.addEventListener("user_session_updated",d),()=>window.removeEventListener("user_session_updated",d)),[]),e.jsxs("div",{className:"max-w-[580px] mx-auto pt-6 px-4",children:[e.jsx(R,{onClick:()=>a(!0),userName:t.name}),e.jsx(H,{isOpen:s,onClose:y,onPostSuccess:d,user:t,postToView:x}),e.jsx("div",{className:"space-y-4 mt-4 pb-10",children:r?e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx(N,{})]}):u.map(o=>e.jsx(J,{post:o,onOpenComments:()=>p(o)},o.id))})]})}export{X as default};
